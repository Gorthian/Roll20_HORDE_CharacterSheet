
<!--
CREATED by          Gorthian
Version				0.1
Letzte Änderung		2025-03-22
GitHub				https://github.com/Gorthian/Roll20_HORDE_CharacterSheet
Wiki				
Bugs & Issues		

-->
<!-- Globale Variablen-->
<!-- - Platz für globale Variablen, falls benötigt-->
<!--
********************************
* START horde.pug
********************************
-->
<!--
********************************
* START src/html/sheet.pug
********************************

-->
<div class="sheet-horde">
  <div class="sheet-logo"><img src="http://gorthian.de/roll20/horde/HORDE_Logo.webp"/></div>
  <div class="sheet-kopfzeile sheet-horde-zeile">
    <div class="sheet-name"><span data-i18n="name"></span>
      <input type="text" value="" name="attr_character_name"/>
    </div>
    <div class="sheet-lebenspunkte"><span data-i18n="lebenspunkte"></span>
      <input type="number" value="" name="attr_hp"/>
      <input type="number" value="" name="attr_hp_max"/>
    </div>
    <div class="sheet-klasse"><span data-i18n="klasse"></span>
      <input type="text" value="" name="attr_klasse"/>
    </div>
  </div>
  <div class="sheet-attribute sheet-horde-zeile">
    <!-- MIXIN : src/html/sheet.pug : attribut-->
    <div class="sheet-attribut">
      <h2 data-i18n="intelligenz"></h2>
      <input class="sheet-d20" type="number" value="" name="attr_intelligenz"/>
      <button class="sheet-d20" type="action" name="act_probe-intelligenz"><img src="http://gorthian.de/roll20/horde/d20.webp"/></button><span data-i18n="basis"></span><span data-i18n="bonus"></span>
      <input type="number" value="" name="attr_intelligenz_bonus"/>
    </div>
    <!-- MIXIN : src/html/sheet.pug : attribut-->
    <div class="sheet-attribut">
      <h2 data-i18n="mut"></h2>
      <input class="sheet-d20" type="number" value="" name="attr_mut"/>
      <button class="sheet-d20" type="action" name="act_probe-mut"><img src="http://gorthian.de/roll20/horde/d20.webp"/></button><span data-i18n="basis"></span><span data-i18n="bonus"></span>
      <input type="number" value="" name="attr_mut_bonus"/>
    </div>
    <!-- MIXIN : src/html/sheet.pug : attribut-->
    <div class="sheet-attribut">
      <h2 data-i18n="koerperkraft"></h2>
      <input class="sheet-d20" type="number" value="" name="attr_koerperkraft"/>
      <button class="sheet-d20" type="action" name="act_probe-koerperkraft"><img src="http://gorthian.de/roll20/horde/d20.webp"/></button><span data-i18n="basis"></span><span data-i18n="bonus"></span>
      <input type="number" value="" name="attr_koerperkraft_bonus"/>
    </div>
    <!-- MIXIN : src/html/sheet.pug : attribut-->
    <div class="sheet-attribut">
      <h2 data-i18n="geschick"></h2>
      <input class="sheet-d20" type="number" value="" name="attr_geschick"/>
      <button class="sheet-d20" type="action" name="act_probe-geschick"><img src="http://gorthian.de/roll20/horde/d20.webp"/></button><span data-i18n="basis"></span><span data-i18n="bonus"></span>
      <input type="number" value="" name="attr_geschick_bonus"/>
    </div>
    <!-- MIXIN : src/html/sheet.pug : attribut-->
    <div class="sheet-attribut">
      <h2 data-i18n="charisma"></h2>
      <input class="sheet-d20" type="number" value="" name="attr_charisma"/>
      <button class="sheet-d20" type="action" name="act_probe-charisma"><img src="http://gorthian.de/roll20/horde/d20.webp"/></button><span data-i18n="basis"></span><span data-i18n="bonus"></span>
      <input type="number" value="" name="attr_charisma_bonus"/>
    </div>
  </div>
  <div class="sheet-staerken-schwaechen sheet-horde-zeile">
    <div class="sheet-staerken"> 
      <h2 data-i18n="staerken"></h2>
      <textarea name="attr_staerken" value=""></textarea>
    </div>
    <div class="sheet-schwaechen"> 
      <h2 data-i18n="schwaechen"></h2>
      <textarea name="attr_schwaechen" value=""></textarea>
    </div>
  </div>
  <div class="sheet-notizen sheet-horde-zeile">
    <h2 data-i18n="notizen"></h2>
    <textarea name="attr_notizen" value=""></textarea>
  </div>
  <div class="sheet-vergangenheit sheet-horde-zeile"> 
    <h2 data-i18n="vergangenheit"></h2>
    <textarea name="attr_vergangenheit" value=""></textarea>
  </div>
  <div class="sheet-inventar sheet-horde-zeile"> 
    <h2 data-i18n="waffen-accessoirs"></h2>
    <!-- MIXIN : src/html/sheet.pug : item-->
    <div class="sheet-item">
      <label for="attr_linke-hand" data-i18n="linke-hand"></label>
      <input type="text" value="" name="attr_linke-hand"/>
    </div>
    <!-- MIXIN : src/html/sheet.pug : item-->
    <div class="sheet-item">
      <label for="attr_rechte-hand" data-i18n="rechte-hand"></label>
      <input type="text" value="" name="attr_rechte-hand"/>
    </div>
    <!-- MIXIN : src/html/sheet.pug : item-->
    <div class="sheet-item">
      <label for="attr_finger-1" data-i18n="finger-1"></label>
      <input type="text" value="" name="attr_finger-1"/>
    </div>
    <!-- MIXIN : src/html/sheet.pug : item-->
    <div class="sheet-item">
      <label for="attr_finger-2" data-i18n="finger-2"></label>
      <input type="text" value="" name="attr_finger-2"/>
    </div>
    <!-- MIXIN : src/html/sheet.pug : item-->
    <div class="sheet-item">
      <label for="attr_hals" data-i18n="hals"></label>
      <input type="text" value="" name="attr_hals"/>
    </div>
    <!-- MIXIN : src/html/sheet.pug : item-->
    <div class="sheet-item">
      <label for="attr_ruecken" data-i18n="ruecken"></label>
      <input type="text" value="" name="attr_ruecken"/>
    </div>
    <h2 data-i18n="rucksack"></h2>
    <textarea name="attr_rucksack" value=""></textarea>
  </div>
</div>
<!--
********************************
* ENDE src/html/sheet.pug
********************************
-->
<!--
********************************
* START src/html/rolltemplates.pug
********************************

-->
<rolltemplate class="sheet-rolltemplate-attributsprobe">
  <div class="sheet-template-container">
    <div class="sheet-template-header">{{attribut}} vs {{computed::schwierigkeit}}</div>
    <div class="sheet-template-row">
      <div class="sheet-template-column">Bonus : </div>
      <div class="sheet-template-column">{{computed::bonus}}</div>
    </div>
    <div class="sheet-template-row"> 
      <div class="sheet-template-column">Wurf: </div>
      <div class="sheet-template-column">{{computed::wurf}}</div>
    </div>
    <div class="sheet-template-desc">{{computed::beschreibung}}</div>
  </div>
</rolltemplate>
<!--
********************************
* ENDE src/html/rolltemplates.pug
********************************
-->
<!-- SHEET WORKERS-->
<script type="text/worker">function attributsprobe(attribut) {
    console.log("Starte Attributsprobe");
    getAttrs([attribut,attribut+"_bonus"], function(values) {
        let schwierigkeit = parseInt(values[attribut]||0);
        let bonus = parseInt(values[attribut+"_bonus"]||0);
        startRoll("&{template:attributsprobe} {{attribut="+getTranslationByKey(attribut)+"}} {{wurf=[[1d20]]}} {{schwierigkeit=[["+schwierigkeit+"]]}} {{bonus=[["+bonus+"]]}} {{beschreibung=[[0]]}}", (results) => {
            const wurf = results.results.wurf.result
            const schwierigkeit = results.results.schwierigkeit.result;
            const bonus = results.results.bonus.result;
            let ergebnis = schwierigkeit+bonus-wurf;
            let beschreibung = "";

            if (ergebnis < -10) {beschreibung = getTranslationByKey("info-katastrophaler_fehlschlag");} else
            if (ergebnis < -5 && ergebnis > -11) {beschreibung = getTranslationByKey("info-unangenehmer_fehlschlag");} else
            if (ergebnis < 0 && ergebnis > -6) {beschreibung = getTranslationByKey("info-einfacher_fehlschlag");} else
            if (ergebnis == 0) {beschreibung = getTranslationByKey("info-erfolg");} else
            if (ergebnis > 0 && ergebnis < 6) {beschreibung = getTranslationByKey("info-einfacher_erfolg");} else
            if (ergebnis > 5 && ergebnis < 11) {beschreibung = getTranslationByKey("info-besonderer_erfolg");} else
            if (ergebnis > 10) {beschreibung = getTranslationByKey("info-exzellenter_erfolg");}
            console.log(beschreibung);

            finishRoll(
                results.rollId,
                {
                    wurf: wurf,
                    schwierigkeit: schwierigkeit,
                    bonus: bonus,
                    beschreibung: beschreibung
                }
            )
        });
    });
}

on("clicked:probe-intelligenz", function() {
    attributsprobe("intelligenz");    
});

on("clicked:probe-mut", function() {
    attributsprobe("mut");    
});

on("clicked:probe-koerperkraft", function() {
    attributsprobe("koerperkraft");    
});

on("clicked:probe-geschick", function() {
    attributsprobe("geschick");    
});

on("clicked:probe-charisma", function() {
    attributsprobe("charisma");    
});
</script>
<!--
********************************
* ENDE horde.pug
********************************
-->